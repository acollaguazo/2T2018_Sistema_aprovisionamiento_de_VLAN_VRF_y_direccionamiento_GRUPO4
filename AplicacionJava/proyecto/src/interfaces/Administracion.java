/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package interfaces;

import clases.ConectorDB;
import clases.Consulta;
import clases.Direccionamiento;
import clases.Logs;
import clases.PE;
import clases.Registro;
import clases.SSHConnector;
import clases.User;
import com.jcraft.jsch.JSchException;
import java.io.IOException;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JComboBox;
import javax.swing.JOptionPane;

/**
 *
 * @author HOME
 */
public class Administracion extends javax.swing.JFrame {

    private ConectorDB conDB;
    private User user;
    private PE pe;
    private SSHConnector sshConnector;
    private Consulta consulta;
    private ArrayList<Integer> nvlan = new ArrayList<Integer>();
    private int numeroEnlacesEmpresa;
    private int vlanEmpresa;
    private int maxVlan = 4069;

    /**
     * Creates new form Administracion
     */
    public Administracion() {
        initComponents();
        inicio();

    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLabel3 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        buttonGroup1 = new javax.swing.ButtonGroup();
        buttonGroup2 = new javax.swing.ButtonGroup();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jRadioButton1 = new javax.swing.JRadioButton();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jLabel7 = new javax.swing.JLabel();
        jComboBox1 = new javax.swing.JComboBox<>();
        jTextField1 = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTextArea1 = new javax.swing.JTextArea();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jRadioButton2 = new javax.swing.JRadioButton();
        jLabel8 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jComboBox2 = new javax.swing.JComboBox<>();
        jComboBox3 = new javax.swing.JComboBox<>();
        jLabel10 = new javax.swing.JLabel();
        jComboBox4 = new javax.swing.JComboBox<>();
        jComboBox5 = new javax.swing.JComboBox<>();
        jLabel11 = new javax.swing.JLabel();
        jRadioButton3 = new javax.swing.JRadioButton();
        jComboBox6 = new javax.swing.JComboBox<>();
        jLabel12 = new javax.swing.JLabel();
        jComboBox7 = new javax.swing.JComboBox<>();
        jLabel13 = new javax.swing.JLabel();
        jComboBox8 = new javax.swing.JComboBox<>();
        jLabel14 = new javax.swing.JLabel();
        jComboBox9 = new javax.swing.JComboBox<>();
        jLabel15 = new javax.swing.JLabel();
        jComboBox10 = new javax.swing.JComboBox<>();
        jLabel16 = new javax.swing.JLabel();
        jTextField2 = new javax.swing.JTextField();
        jLabel18 = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();

        jLabel3.setText("jLabel3");

        jLabel6.setText("jLabel6");

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel1.setText("ROUTER");
        getContentPane().add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 20, 70, 29));

        jLabel2.setForeground(new java.awt.Color(255, 255, 255));
        getContentPane().add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 50, 73, 29));

        buttonGroup1.add(jRadioButton1);
        jRadioButton1.setForeground(new java.awt.Color(255, 255, 255));
        jRadioButton1.setText("CREAR VLAN");
        jRadioButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jRadioButton1ActionPerformed(evt);
            }
        });
        getContentPane().add(jRadioButton1, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 103, -1, -1));

        jLabel4.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel4.setForeground(new java.awt.Color(255, 255, 255));
        jLabel4.setText("EMPRESA");
        getContentPane().add(jLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 100, 70, -1));

        jLabel5.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel5.setForeground(new java.awt.Color(240, 240, 240));
        jLabel5.setText("VLAN");
        getContentPane().add(jLabel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 180, -1, -1));

        jLabel7.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel7.setForeground(new java.awt.Color(255, 255, 255));
        jLabel7.setText("CIUDAD");
        getContentPane().add(jLabel7, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 140, -1, -1));

        jComboBox1.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Seleccione..." }));
        jComboBox1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboBox1ActionPerformed(evt);
            }
        });
        getContentPane().add(jComboBox1, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 100, -1, -1));
        getContentPane().add(jTextField1, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 180, 87, -1));

        jTextArea1.setColumns(20);
        jTextArea1.setRows(5);
        jScrollPane1.setViewportView(jTextArea1);

        getContentPane().add(jScrollPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(450, 250, 248, 314));

        jButton1.setText("SHOW RUN");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton1, new org.netbeans.lib.awtextra.AbsoluteConstraints(540, 50, -1, 44));

        jButton2.setText("EJECUTAR");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton2, new org.netbeans.lib.awtextra.AbsoluteConstraints(540, 160, 85, 37));

        buttonGroup1.add(jRadioButton2);
        jRadioButton2.setForeground(new java.awt.Color(255, 255, 255));
        jRadioButton2.setText("CREAR VRF");
        jRadioButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jRadioButton2ActionPerformed(evt);
            }
        });
        getContentPane().add(jRadioButton2, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 248, -1, -1));

        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel8.setForeground(new java.awt.Color(255, 255, 255));
        jLabel8.setText("EMPRESA");
        getContentPane().add(jLabel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 250, -1, -1));

        jLabel9.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel9.setForeground(new java.awt.Color(255, 255, 255));
        jLabel9.setText("VLAN");
        getContentPane().add(jLabel9, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 340, 44, 27));

        jComboBox2.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Seleccione..." }));
        jComboBox2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboBox2ActionPerformed(evt);
            }
        });
        getContentPane().add(jComboBox2, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 250, -1, 20));

        jComboBox3.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Seleccione..." }));
        getContentPane().add(jComboBox3, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 340, -1, 20));

        jLabel10.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel10.setForeground(new java.awt.Color(255, 255, 255));
        jLabel10.setText("CIUDAD");
        getContentPane().add(jLabel10, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 300, 57, 21));

        jComboBox4.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Seleccione..." }));
        jComboBox4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboBox4ActionPerformed(evt);
            }
        });
        getContentPane().add(jComboBox4, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 300, -1, -1));

        jComboBox5.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Seleccione..." }));
        getContentPane().add(jComboBox5, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 140, -1, -1));

        jLabel11.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel11.setForeground(new java.awt.Color(255, 255, 255));
        jLabel11.setText("EMPRESA");
        getContentPane().add(jLabel11, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 420, -1, -1));

        buttonGroup1.add(jRadioButton3);
        jRadioButton3.setForeground(new java.awt.Color(255, 255, 255));
        jRadioButton3.setText("ASIGNAR ENLACES");
        jRadioButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jRadioButton3ActionPerformed(evt);
            }
        });
        getContentPane().add(jRadioButton3, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 417, -1, -1));

        jComboBox6.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Seleccione..." }));
        jComboBox6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboBox6ActionPerformed(evt);
            }
        });
        getContentPane().add(jComboBox6, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 420, -1, -1));

        jLabel12.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel12.setForeground(new java.awt.Color(255, 255, 255));
        jLabel12.setText("CIUDAD");
        getContentPane().add(jLabel12, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 450, 50, -1));

        jComboBox7.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Seleccione...", " " }));
        jComboBox7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboBox7ActionPerformed(evt);
            }
        });
        getContentPane().add(jComboBox7, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 450, -1, 20));

        jLabel13.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel13.setForeground(new java.awt.Color(255, 255, 255));
        jLabel13.setText("VLAN");
        getContentPane().add(jLabel13, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 490, -1, -1));

        jComboBox8.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Seleccione..." }));
        getContentPane().add(jComboBox8, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 490, -1, -1));

        jLabel14.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel14.setForeground(new java.awt.Color(255, 255, 255));
        jLabel14.setText("VRF");
        getContentPane().add(jLabel14, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 530, 25, -1));

        jComboBox9.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Seleccione..." }));
        jComboBox9.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboBox9ActionPerformed(evt);
            }
        });
        getContentPane().add(jComboBox9, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 530, -1, -1));

        jLabel15.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel15.setForeground(new java.awt.Color(255, 255, 255));
        jLabel15.setText("ROUTER (PE)");
        getContentPane().add(jLabel15, new org.netbeans.lib.awtextra.AbsoluteConstraints(160, 580, -1, -1));

        jComboBox10.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Seleccione..." }));
        getContentPane().add(jComboBox10, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 580, 88, -1));

        jLabel16.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        jLabel16.setForeground(new java.awt.Color(255, 255, 255));
        jLabel16.setText("Enlaces");
        getContentPane().add(jLabel16, new org.netbeans.lib.awtextra.AbsoluteConstraints(170, 610, -1, 24));

        jTextField2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField2ActionPerformed(evt);
            }
        });
        getContentPane().add(jTextField2, new org.netbeans.lib.awtextra.AbsoluteConstraints(270, 620, 88, -1));

        jLabel18.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel18.setForeground(new java.awt.Color(255, 255, 255));
        jLabel18.setText("SISTEMA DE APROVISIONAMIENTO");
        getContentPane().add(jLabel18, new org.netbeans.lib.awtextra.AbsoluteConstraints(230, 10, -1, -1));

        jLabel17.setIcon(new javax.swing.ImageIcon(getClass().getResource("/interfaces/fondo.png"))); // NOI18N
        getContentPane().add(jLabel17, new org.netbeans.lib.awtextra.AbsoluteConstraints(-570, 0, -1, 710));

        pack();
    }// </editor-fold>//GEN-END:initComponents
    //función que hace visible las opciones de crear VLAN cuando se seleccione
    private void jRadioButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jRadioButton1ActionPerformed
        //AsignaEmpresaJCombo();
        asignaCampoJcombo(jComboBox1, "empresa", "razonSocial");
        //AsignarCiudadJCombo();
        asignaCampoJcombo(jComboBox5, "ciudad", "nombre");
        if (jRadioButton1.isSelected()) {
            jLabel4.setVisible(true);
            jLabel5.setVisible(true);
            jLabel7.setVisible(true);
            jComboBox1.setVisible(true);
            jTextField1.setVisible(true);
            jComboBox5.setVisible(true);
            jLabel8.setVisible(false);
            jLabel9.setVisible(false);
            jLabel10.setVisible(false);
            jComboBox2.setVisible(false);
            jComboBox3.setVisible(false);
            jComboBox4.setVisible(false);
            jLabel11.setVisible(false);
            jLabel12.setVisible(false);
            jLabel13.setVisible(false);
            jLabel14.setVisible(false);
            jLabel15.setVisible(false);
            jLabel16.setVisible(false);
            jComboBox6.setVisible(false);
            jComboBox7.setVisible(false);
            jComboBox8.setVisible(false);
            jComboBox9.setVisible(false);
            jComboBox10.setVisible(false);
            jTextField2.setVisible(false);
        }
    }//GEN-LAST:event_jRadioButton1ActionPerformed
    //Función que se encarga de hacer un show run al router que selecciono al iniciar sesión
    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        try {
            sshConnector.connect(user, pe, Inicio.puertoSSH);
            String result = sshConnector.executeCommand("show run\n       ");
            jTextArea1.setText(result);
            sshConnector.disconnect();
        } catch (IllegalAccessException ex) {
            Logger.getLogger(Administracion.class.getName()).log(Level.SEVERE, null, ex);
        } catch (JSchException ex) {
            Logger.getLogger(Administracion.class.getName()).log(Level.SEVERE, null, ex);
        } catch (IOException ex) {
            Logger.getLogger(Administracion.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_jButton1ActionPerformed
    //función que hace visible las opciones de crear VRF cuando se seleccione
    private void jRadioButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jRadioButton2ActionPerformed
        asignaCampoJcombo(jComboBox2, "empresa", "razonSocial");
        asignaCampoJcombo(jComboBox4, "ciudad", "nombre");
        if (jRadioButton2.isSelected()) {
            jLabel4.setVisible(false);
            jLabel5.setVisible(false);
            jLabel7.setVisible(false);
            jComboBox1.setVisible(false);
            jTextField1.setVisible(false);
            jComboBox5.setVisible(false);
            jLabel8.setVisible(true);
            jLabel9.setVisible(true);
            jLabel10.setVisible(true);
            jComboBox2.setVisible(true);
            jComboBox3.setVisible(true);
            jComboBox4.setVisible(true);
            jLabel11.setVisible(false);
            jLabel12.setVisible(false);
            jLabel13.setVisible(false);
            jLabel14.setVisible(false);
            jLabel15.setVisible(false);
            jLabel16.setVisible(false);
            jComboBox6.setVisible(false);
            jComboBox7.setVisible(false);
            jComboBox8.setVisible(false);
            jComboBox9.setVisible(false);
            jComboBox10.setVisible(false);
            jTextField2.setVisible(false);
        }
    }//GEN-LAST:event_jRadioButton2ActionPerformed
    //Función que se encarga de crear una VLAN, crear VRF o asignar vlan según los datos
    //que ingrese el usuario y validando los mismos
    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed

        //la opcion de crear vlan
        if (jRadioButton1.isSelected()) {
            //valida si los campos son correctamente llenados y seleccionados
            if (!(jComboBox1.getSelectedItem().toString().equals("Seleccione...")) && !(jTextField1.getText().equals("")) && !(jComboBox5.getSelectedItem().toString().equals("Seleccione..."))) {
                //verifica si la vlan es un numero
                if (isNumeric(jTextField1.getText())) {
                    //verifica si la vlan es un numero entre 1-4096
                    if ((Integer.parseInt(jTextField1.getText()) >= 1) && (Integer.parseInt(jTextField1.getText()) <= maxVlan)) {

                        switch (existeVlanCiudad()) {

                            case 0:
                                JOptionPane.showMessageDialog(null, "no hay vlan disponibles en la ciudad" + jComboBox5.getSelectedItem().toString());
                                break;
                            case -1:
                                if (!poseeVLANempresa()) {
                                    registrarvlanBD_R(Integer.parseInt(jTextField1.getText()), jComboBox5.getSelectedItem().toString(), jComboBox1.getSelectedItem().toString(), -1);

                                } else {

                                    int closeSelected = JOptionPane.showConfirmDialog(null, "¿desea que se cree otra vlan para la empresa?", "Alerta", JOptionPane.YES_NO_OPTION);
                                    if (closeSelected == JOptionPane.YES_OPTION) {
                                        registrarvlanBD_R(Integer.parseInt(jTextField1.getText()), jComboBox5.getSelectedItem().toString(), jComboBox1.getSelectedItem().toString(), -1);
                                    } else {
                                        System.out.println("NO SE CREO VLAN");
                                    }

                                }

                                break;
                            case 1://existe vlan dentro de la ciudad
                                System.out.println("vlan existe se asignara otra");
                                JOptionPane.showMessageDialog(null, "VLAN " + jTextField1.getText() + " existe");
                                if (!poseeVLANempresa()) {
                                    for (int i = 1; i <= maxVlan; i++) {
                                        for (int v : nvlan) {
                                            if (i != v) {
                                                registrarvlanBD_R(i, jComboBox5.getSelectedItem().toString(), jComboBox1.getSelectedItem().toString(), 1);

                                                i = (maxVlan + 1);
                                                break;
                                            }

                                        }

                                    }

                                } else {
                                    System.out.println("la vlan existe y la empresa tiene una vlan quiere otra");

                                    for (int i = 1; i <= maxVlan; i++) {
                                        for (int v : nvlan) {
                                            if (i != v) {
                                                int closeSelected = JOptionPane.showConfirmDialog(null, "¿desea que se cree otra vlan para la empresa?", "Alerta", JOptionPane.YES_NO_OPTION);
                                                if (closeSelected == JOptionPane.YES_OPTION) {
                                                    registrarvlanBD_R(i, jComboBox5.getSelectedItem().toString(), jComboBox1.getSelectedItem().toString(), 1);
                                                    System.out.println("se creo vlan");
                                                } else {
                                                    System.out.println("NO SE CREO VLAN");
                                                }
                                                i = (maxVlan + 1);
                                                break;
                                            }

                                        }

                                    }

                                }

                                break;
                            default:
                                break;

                        }
                    } else {
                        JOptionPane.showMessageDialog(null, "El número de VLAN debe de ser entre 1 a 4096 vuelva a intentarlo.");
                    }
                } else {
                    JOptionPane.showMessageDialog(null, "El número de VLAN debe de ser entre 1 a 4096 vuelva a intentarlo.");
                }
            } else {
                JOptionPane.showMessageDialog(null, "Campos incompletos, vuelva a intentar.");
            }
        } else if (jRadioButton2.isSelected()) {

            if (!(jComboBox2.getSelectedItem().toString().equals("Seleccione...")) && !(jComboBox3.getSelectedItem().toString().equals("Seleccione...")) && !(jComboBox4.getSelectedItem().toString().equals("Seleccione..."))) {

                String nombreVRF = obtenerVRF(jComboBox9, jComboBox2);
                if (nombreVRF.equals("no_existe")) {
                    registrarVrfRoutBD(Integer.parseInt(jComboBox3.getSelectedItem().toString()), jComboBox2.getSelectedItem().toString(), jComboBox4.getSelectedItem().toString());
                } else {
                    JOptionPane.showMessageDialog(null, "existe VRF" + nombreVRF + "PARA la empresa " + jComboBox2.getSelectedItem().toString() + " seleccionada");
                }

            } else {
                JOptionPane.showMessageDialog(null, "Falta información, inténtelo de nuevo");
            }

        } else if (jRadioButton3.isSelected()) {

            if (!(jComboBox6.getSelectedItem().toString().equals("Seleccione...")) && !(jComboBox7.getSelectedItem().toString().equals("Seleccione...")) && !(jComboBox8.getSelectedItem().toString().equals("Seleccione...")) && !(jComboBox9.getSelectedItem().toString().equals("Seleccione...")) && !(jComboBox10.getSelectedItem().toString().equals("Seleccione...")) && !(jTextField2.getText().equals(""))) {
                String empresa = jComboBox6.getSelectedItem().toString();
                String ciudad = jComboBox7.getSelectedItem().toString();
                int vlan = Integer.parseInt(jComboBox8.getSelectedItem().toString());
                String vrf = jComboBox9.getSelectedItem().toString();
                String router = jComboBox10.getSelectedItem().toString();
                int noEnlace = 0;
                try {

                    String enlace = asignarEnlace();
                    System.out.println(enlace);
                    if (enlace.equals("")) {
                        JOptionPane.showMessageDialog(null, "No se asigno direccionamiento");
                    } else {
                        String[] a = enlace.split(",");
                        String ip = "";
                        noEnlace = Integer.parseInt(a[2]);
                        char[] w = a[0].toCharArray();
                        int cont = 0;
                        String ultimobit = "";
                        for (char x : w) {
                            if (cont == 3) {
                                ultimobit = ultimobit + x;
                            } else {
                                ip = ip + x;
                            }
                            if (x == '.') {
                                cont++;
                            }

                        }
                        ip = ip + Integer.toString((Integer.parseInt(ultimobit) + 1));
                        System.out.println(ip);

                        PE PE_SSH = null;

                        sshConnector = new SSHConnector();
                        for (PE pe : Inicio.pes) {

                            if (ciudad.equals(pe.getCiudad())) {
                                PE_SSH = new PE(pe.getNombre(), pe.getCiudad(), pe.getDireccionIP(), pe.getInt_vlan());
                                break;
                            }
                        }
                        sshConnector = new SSHConnector();
                        sshConnector.connect(user, PE_SSH, Inicio.puertoSSH);
                        String result = sshConnector.executeCommand("config t\ninterface " + PE_SSH.getInt_vlan() + "." + vlan + "\nip address " + ip + " " + a[1] + "\n");
                        jTextArea1.setText(result);
                        sshConnector.disconnect();

                        conDB = new ConectorDB();
                        Connection reg = conDB.getConnection();
                        Registro r = new Registro();
                        if (a.length < 4) {
                            r.registrarDireccionamiento(reg, a[0], a[1], empresa, ciudad, vlan, vrf, PE_SSH.getNombre(), noEnlace);
                        } else {
                            if (a[3].equals("agregoensubred")) {
                                r.modificartabla(reg, "direccionamiento", "dir_red", a[0], "enlaces", a[2]);
                            }
                        }

                        reg.close();
                        conDB.desconectar();

                    }

                    asignarEnlace();
                } catch (JSchException ex) {
                    JOptionPane.showMessageDialog(null, "Falla en la conexión con el dispositivo PE, inténtelo más tarde");
                    Logger.getLogger(Administracion.class.getName()).log(Level.SEVERE, null, ex);
                } catch (IllegalAccessException ex) {
                    Logger.getLogger(Administracion.class.getName()).log(Level.SEVERE, null, ex);
                } catch (IOException ex) {
                    Logger.getLogger(Administracion.class.getName()).log(Level.SEVERE, null, ex);
                } catch (Exception e) {
                    System.out.println("ERROR");
                }
            } else {
                JOptionPane.showMessageDialog(null, "Falta información, inténtelo de nuevo");
            }

        } else {
            System.out.println("DEBE SELECCIONAR ALGO");
        }
        for (int z : nvlan) {
            System.out.println(z);
        }
        nvlan.clear();
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jComboBox2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBox2ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jComboBox2ActionPerformed
    //Función que valida si selecciono primero la empresa antes de seleccionar la VLAN 
    //para la creación de una VRF y de ser correcto asigna las VLANs de la base de datos
    //al ComboBox
    private void jComboBox4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBox4ActionPerformed
        if (jComboBox2.getSelectedItem().toString().equals("Seleccione...")) {
            JOptionPane.showMessageDialog(null, "Primero seleccione empresa");
        } else {
            asignandoVLANComboBox(jComboBox3, jComboBox2, jComboBox4);
        }
    }//GEN-LAST:event_jComboBox4ActionPerformed
    //función que hace visible las opciones de asignar enlaces cuando se seleccione
    private void jRadioButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jRadioButton3ActionPerformed

        asignaCampoJcombo(jComboBox6, "empresa", "razonSocial");

        asignaCampoJcombo(jComboBox7, "ciudad", "nombre");
        asignaCampoJcombo(jComboBox10, "providerEdge", "nombrePE");
        if (jRadioButton3.isSelected()) {
            jLabel11.setVisible(true);
            jLabel12.setVisible(true);
            jLabel13.setVisible(true);
            jLabel14.setVisible(true);
            jLabel15.setVisible(true);
            jLabel16.setVisible(true);
            jComboBox6.setVisible(true);
            jComboBox7.setVisible(true);
            jComboBox8.setVisible(true);
            jComboBox9.setVisible(true);
            jComboBox10.setVisible(true);
            jTextField2.setVisible(true);
            jLabel4.setVisible(false);
            jLabel5.setVisible(false);
            jLabel7.setVisible(false);
            jLabel8.setVisible(false);
            jLabel9.setVisible(false);
            jLabel10.setVisible(false);
            jComboBox1.setVisible(false);
            jComboBox2.setVisible(false);
            jComboBox3.setVisible(false);
            jComboBox4.setVisible(false);
            jTextField1.setVisible(false);
            jComboBox5.setVisible(false);

        }
    }//GEN-LAST:event_jRadioButton3ActionPerformed

    private void jTextField2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField2ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jTextField2ActionPerformed
    //Función que valida si selecciono primero la empresa antes de seleccionar la VLAN 
    //para la asignación de enlaces y de ser correcto asigna las VLANs de la base de datos
    //al ComboBox además de hacer la seleción de router PE
    private void jComboBox7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBox7ActionPerformed
        if (jComboBox6.getSelectedItem().toString().equals("Seleccione...")) {
            JOptionPane.showMessageDialog(null, "Primero seleccione empresa");
        } else {
            asignandoVLANComboBox(jComboBox8, jComboBox6, jComboBox7);
            seleccionarPE(jComboBox7.getSelectedItem().toString(), jComboBox10);

        }
    }//GEN-LAST:event_jComboBox7ActionPerformed

    private void jComboBox9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBox9ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jComboBox9ActionPerformed
    //Función que obtiene las VRF para incluir al ComboBox
    private void jComboBox6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBox6ActionPerformed
        String z = obtenerVRF(jComboBox9, jComboBox6);
    }//GEN-LAST:event_jComboBox6ActionPerformed

    private void jComboBox1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBox1ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jComboBox1ActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(Administracion.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(Administracion.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(Administracion.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(Administracion.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Administracion().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.ButtonGroup buttonGroup2;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JComboBox<String> jComboBox1;
    private javax.swing.JComboBox<String> jComboBox10;
    private javax.swing.JComboBox<String> jComboBox2;
    private javax.swing.JComboBox<String> jComboBox3;
    private javax.swing.JComboBox<String> jComboBox4;
    private javax.swing.JComboBox<String> jComboBox5;
    private javax.swing.JComboBox<String> jComboBox6;
    private javax.swing.JComboBox<String> jComboBox7;
    private javax.swing.JComboBox<String> jComboBox8;
    private javax.swing.JComboBox<String> jComboBox9;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JRadioButton jRadioButton1;
    private javax.swing.JRadioButton jRadioButton2;
    private javax.swing.JRadioButton jRadioButton3;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTextArea jTextArea1;
    private javax.swing.JTextField jTextField1;
    private javax.swing.JTextField jTextField2;
    // End of variables declaration//GEN-END:variables

    public void setPE(PE pe) {
        this.pe = pe;
    }

    public void setUser(User user) {
        this.user = user;
    }

    public void setConectorDB(ConectorDB con) {
        this.conDB = con;
    }

    public void setSSHConector(SSHConnector sshConnector) {
        this.sshConnector = sshConnector;
    }

    public void setjLabelRouter(String nameR) {
        jLabel2.setText(nameR);
    }

    public void inicio() {

        jLabel4.setVisible(false);
        jLabel5.setVisible(false);
        jLabel7.setVisible(false);
        jLabel8.setVisible(false);
        jLabel9.setVisible(false);
        jLabel10.setVisible(false);
        jComboBox1.setVisible(false);
        jComboBox2.setVisible(false);
        jComboBox3.setVisible(false);
        jComboBox4.setVisible(false);
        jTextField1.setVisible(false);
        jComboBox5.setVisible(false);

        jLabel11.setVisible(false);
        jLabel12.setVisible(false);
        jLabel13.setVisible(false);
        jLabel14.setVisible(false);
        jLabel15.setVisible(false);
        jLabel16.setVisible(false);
        jComboBox6.setVisible(false);
        jComboBox7.setVisible(false);
        jComboBox8.setVisible(false);
        jComboBox9.setVisible(false);
        jComboBox10.setVisible(false);
        jTextField2.setVisible(false);

    }

    //Función que se encarga de asignar los valores de la base de datos a un combo box
    //recibe como entrada el ComboBox al cual desee asignarle datos y un String del nombre de la tabla
    //de la base de datos y el nombre del campo a llenar
    public void asignaCampoJcombo(JComboBox jCombo, String nombreTabla, String nombreCampo) {
        jCombo.removeAllItems();
        jCombo.addItem("Seleccione...");
        try {
            conDB = new ConectorDB();
            Connection reg = conDB.getConnection();
            consulta = new Consulta();
            ResultSet rs = consulta.getResultSetTabla(reg, nombreTabla);
            if (rs != null) {
                while (rs.next()) {
                    jCombo.addItem(rs.getString(nombreCampo));
                }
            } else {
                System.out.println("ERROR");
            }
            rs.close();
            reg.close();
            conDB.desconectar();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    //Función que se encarga de verificar si un dato es no numérico recibe como entrada el dato 
    //de tipo String y devuelve un valor booleano con la respuesta.
    public static boolean isNumeric(String cadena) {

        boolean resultado;

        try {
            Integer.parseInt(cadena);
            resultado = true;
        } catch (NumberFormatException excepcion) {
            resultado = false;
        }

        return resultado;
    }

    //Función que se encarga de verificar si existe la VLAN en la ciudad devolviendo 
    //como resultado un dato tipo entero con las opciones -1, 1 y 0 según los resultados
    public int existeVlanCiudad() {
        int cont = 0;
        int op = -1;
        try {
            conDB = new ConectorDB();
            Connection reg = conDB.getConnection();
            consulta = new Consulta();
            ResultSet rs = consulta.getResultSetTabla(reg, "vlan");
            if (rs != null) {
                while (rs.next()) {
                    if (jComboBox5.getSelectedItem().toString().equals(rs.getString("ciudad"))) {
                        nvlan.add(rs.getInt("N_vlan"));
                        cont++; //contador de vlan dentro de la ciudad
                        if (jTextField1.getText().equals(rs.getString("N_vlan"))) {
                            op = 1; //da un valor de 1 si esta el numero vlan dentro de la ciudad
                        }

                    }
                }
            } else {
                System.out.println("rsvacio");

            }
            rs.close();
            reg.close();
            conDB.desconectar();
        } catch (Exception e) {
            e.printStackTrace();
        }
        if (cont == maxVlan) {
            op = 0; //si el contador de vlans es 4096 entonces cambia op a pesar de que haya  un numero de vlan
        }           //  corrige el error en que existe vlan y haya 4096 vlans 
        Collections.sort(nvlan);
        return op; //retorna valor -1 cuando no existe vlan en ciudad
    }

    //Función que se encarga de verificar si una empresa posee VLAN o no devolviendo
    //como resultado un dato booleano
    public boolean poseeVLANempresa() {
        try {
            conDB = new ConectorDB();
            Connection reg = conDB.getConnection();
            consulta = new Consulta();
            ResultSet rs = consulta.getResultSetTabla(reg, "vlan");
            if (rs != null) {
                while (rs.next()) {
                    if (jComboBox5.getSelectedItem().toString().equals(rs.getString("ciudad"))
                            && jComboBox1.getSelectedItem().toString().equals(rs.getString("empresa"))) {
                        rs.close();
                        reg.close();
                        conDB.desconectar();
                        return true;
                    }
                }
            } else {
                System.out.println("rsvacio");

            }
            rs.close();
            reg.close();
            conDB.desconectar();
        } catch (Exception e) {
            e.printStackTrace();
        }
        return false;
    }

    //Función que se encarga de asignar las VLAN a un ComboBox recibiendo como dato de 
    //entrada el valor de los ComboBox de la VLAN, de la empresa y de la ciudad
    public void asignandoVLANComboBox(JComboBox jComboVLAN, JComboBox jComboEmpresa, JComboBox jComboCiudad) {
        jComboVLAN.removeAllItems();
        jComboVLAN.addItem("Seleccione...");

        try {
            conDB = new ConectorDB();
            Connection reg = conDB.getConnection();
            consulta = new Consulta();
            ResultSet rs = consulta.getResultSetTabla(reg, "vlan");
            if (rs != null) {
                while (rs.next()) {
                    if ((jComboEmpresa.getSelectedItem().toString().equals(rs.getString("empresa"))) && (jComboCiudad.getSelectedItem().toString().equals(rs.getString("ciudad")))) {
                        jComboVLAN.addItem(rs.getString("N_vlan"));

                    }

                }
            } else {
                System.out.println("ERROR");
            }
            rs.close();
            reg.close();
            conDB.desconectar();
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    //Función que se encarga de registrar la VLAN en la base de datos recibiendo como datos
    //de entrada un entero de la vlan, un string de la ciudad, un string de la empresa
    //y un entero de la opción que va a realizar.
    public void registrarvlanBD_R(int vlan, String ciudad, String empresa, int option) {
        try {
            conDB = new ConectorDB();
            Connection reg = conDB.getConnection();
            Registro r = new Registro();
            r.registrarVLAN(reg, vlan, ciudad, empresa);
            reg.close();
            conDB.desconectar();

            try {
                PE PE_SSH = null;

                sshConnector = new SSHConnector();
                for (PE pe : Inicio.pes) {

                    if (ciudad.equals(pe.getCiudad())) {
                        PE_SSH = new PE(pe.getNombre(), pe.getCiudad(), pe.getDireccionIP(), pe.getInt_vlan());
                        break;
                    }
                }
                System.out.println(PE_SSH.toString());
                sshConnector.connect(user, PE_SSH, Inicio.puertoSSH);

                String result = sshConnector.executeCommand("conf t\n" + "int f0/0." + vlan + "\n" + "encapsulation dot1q " + vlan + "\n" + "description VLAN-DE-EMPRESA-" + empresa + "\n" + "do wr \n\n");
                jTextArea1.setText(result);
                sshConnector.disconnect();
                if (option == -1) {
                    JOptionPane.showMessageDialog(null, "VLAN " + vlan + " creada exitosamente en la ciudad " + ciudad + " para la empresa " + empresa);
                    Logs logs = new Logs("VLAN " + vlan + " creada exitosamente en la ciudad " + ciudad + " para la empresa " + empresa);
                } else if (option == 1) {
                    JOptionPane.showMessageDialog(null, "Se asigno una VLAN nueva " + vlan + " en la ciudad " + ciudad + " para la empresa " + empresa);
                    Logs logs = new Logs("Se asigno una VLAN nueva " + vlan + " en la ciudad " + ciudad + " para la empresa " + empresa);
                }

            } catch (JSchException e) {
                e.printStackTrace();
            } catch (IllegalAccessException ex) {
                Logger.getLogger(Administracion.class.getName()).log(Level.SEVERE, null, ex);
            } catch (IOException ex) {
                Logger.getLogger(Administracion.class.getName()).log(Level.SEVERE, null, ex);
            }

        } catch (SQLException ex) {
            Logger.getLogger(Administracion.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    //Función que se encarga de registrar una VRF en la base de datos recibiendo como datos de entrada
    //un entero de la VLAN, un string de la empresa y un string de la ciudad.
    public void registrarVrfRoutBD(int vlan, String empresa, String ciudad) {
        conDB = new ConectorDB();
        Connection reg = conDB.getConnection();
        Registro r = new Registro();
        String nombreVRF = "VRF_" + empresa + "_" + vlan + "";
        System.out.println(nombreVRF);
        r.registrarVRF(reg, nombreVRF, vlan, ciudad, empresa);

        try {
            PE PE_SSH = null;

            sshConnector = new SSHConnector();
            for (PE pe : Inicio.pes) {

                if (ciudad.equals(pe.getCiudad())) {
                    PE_SSH = new PE(pe.getNombre(), pe.getCiudad(), pe.getDireccionIP(), pe.getInt_vlan());
                    break;
                }
            }
            System.out.println(PE_SSH.toString());
            sshConnector.connect(user, PE_SSH, Inicio.puertoSSH);
            String result = sshConnector.executeCommand("config t\nip vrf " + nombreVRF + "\nrd 1:" + vlan + "\nroute-target export 1:" + vlan + "\nroute-target import 1:" + vlan + "\nint f0/0." + vlan + "\nip vrf forwarding " + nombreVRF + "\ndo wr\n" + "" + "\ndo wr\n\n ");
            jTextArea1.setText(result);
            sshConnector.disconnect();
            JOptionPane.showMessageDialog(null, "se creo" + nombreVRF + " para la empresa " + empresa + " con vlan " + vlan);
            Logs logs = new Logs("se creo" + nombreVRF + " para la empresa " + empresa + " con vlan " + vlan);
        } catch (JSchException e) {
            e.printStackTrace();
        } catch (IllegalAccessException ex) {
            Logger.getLogger(Administracion.class.getName()).log(Level.SEVERE, null, ex);
        } catch (IOException ex) {
            Logger.getLogger(Administracion.class.getName()).log(Level.SEVERE, null, ex);
        }

    }

    //Función que se encarga de obtener la vrf del ComboBox recibiendo como datos de entrada
    //el ComboBox de la VRF y el de la empresa en ese orden para devolver un dato string
    //con el nombre de la vrf
    public String obtenerVRF(JComboBox jComboVRF, JComboBox jComboEmpresa) {
        jComboVRF.removeAllItems();
        jComboVRF.addItem("Seleccione...");

        String nombreVRF = "no_existe";
        try {
            conDB = new ConectorDB();

            Connection reg = conDB.getConnection();

            consulta = new Consulta();

            ResultSet rs = consulta.getResultSetTabla(reg, "VRF");

            if (rs != null) {

                while (rs.next()) {

                    if (jComboEmpresa.getSelectedItem().toString().equals(rs.getString("empresa"))) {
                        nombreVRF = rs.getString("nombreVRF");
                        jComboVRF.addItem(rs.getString("nombreVRF"));
                        break;
                    }
                }
            } else {
                System.out.println("rsvacio");

            }
            rs.close();
            reg.close();
            conDB.desconectar();
        } catch (Exception e) {
            System.out.println("abc");
            e.printStackTrace();
        }
        return nombreVRF;
    }

    //Función que se encarga de asignar enlaces devolviendo como dato de salida un String 
    //con la ip, la máscara y si ya contenia enlaces la empresa en esa sucursal
    public String asignarEnlace() {
        Direccionamiento dir = null;
        int numero_Enlaces_Existentes = 0;
        String lineassh = "";
        String mensaje_de_aceptacion = "no";
        try {
            conDB = new ConectorDB();
            Connection reg = conDB.getConnection();
            consulta = new Consulta();
            ResultSet rs = consulta.getResultSetTabla(reg, "direccionamiento");

            if (rs != null) {
                while (rs.next()) {
                    if (jComboBox6.getSelectedItem().toString().equals(rs.getString("empresa"))) {
                        dir = new Direccionamiento(rs.getString("dir_red"), rs.getString("submask_red"), rs.getString("empresa"), rs.getString("ciudad"), rs.getInt("vlan"), rs.getString("nombreVRF"), rs.getString("nombrePE"), rs.getInt("enlaces"));
                        break;
                    }
                }

            } else {
                System.out.println("ERROR");
            }
            rs.close();
            reg.close();
            conDB.desconectar();

            if (dir == null) {
                mensaje_de_aceptacion = "no";
            } else {
                mensaje_de_aceptacion = "si";
                numero_Enlaces_Existentes = dir.getEnlaces();
            }

            //La mascara del ISP puede ser 191.128.0.0/12
            //obtencion de los 3 primeros octetos de la subred
            numeroEnlacesEmpresa = Integer.parseInt(jTextField2.getText());
            vlanEmpresa = Integer.parseInt(jComboBox8.getSelectedItem().toString());

            ArrayList<Integer> listaBinarioVlan = new ArrayList<Integer>();
            //funcion devuelve un arreglo de la vlan en binario
            listaBinarioVlan = binario_list(vlanEmpresa, 13);
            int primer_octeto = 10;
            int segundo_octeto = listaBinarioVlan.get(0) + 2 * listaBinarioVlan.get(1) + 4 * listaBinarioVlan.get(2) + 8 * listaBinarioVlan.get(3) + 16 * listaBinarioVlan.get(4);
            int tercer_octeto = 128 * listaBinarioVlan.get(5) + 64 * listaBinarioVlan.get(6) + 32 * listaBinarioVlan.get(7) + 16 * listaBinarioVlan.get(8)
                    + 8 * listaBinarioVlan.get(9) + 4 * listaBinarioVlan.get(10) + 2 * listaBinarioVlan.get(11) + listaBinarioVlan.get(12);
            int cuarto_octeto = 0;

            //Mascara para la subred
            int primero_mascara = 255, segundo_mascara = 255, tercero_mascara = 255;
            int cuarto_mascara = 255;

            //int numero_Enlaces_Existentes = dir.getEnlaces();//Valor sacado de la base de datos
            for (int i = 1; i < 9; i++) {
                if ((numero_Enlaces_Existentes + 2) < Math.pow(2, i)) {
                    cuarto_mascara = 256 - (int) Math.pow(2, i);
                    i = 9;
                }
            }
            System.out.println(cuarto_mascara);
            int cuarto_mascara_temporal = cuarto_mascara;
            for (int i = 1; i < 9; i++) {
                if ((numeroEnlacesEmpresa + 2 + numero_Enlaces_Existentes) < Math.pow(2, i)) {
                    cuarto_mascara_temporal = 256 - (int) Math.pow(2, i);
                    i = 9;
                }
            }
            System.out.println(cuarto_mascara_temporal);
            cuarto_mascara = cuarto_mascara_temporal;
            int nuevo_numero_de_enlaces = numeroEnlacesEmpresa + numero_Enlaces_Existentes;
            System.out.println("");
            if ((nuevo_numero_de_enlaces + 2) > 256) {
                System.out.println("Excede el numero de enlaces disponibles en el ISP");
                return "";
            } else {
                if (cuarto_mascara_temporal == cuarto_mascara) {
                    if (mensaje_de_aceptacion.equals("si")) {
                        cuarto_mascara = cuarto_mascara_temporal;
                        System.out.println("se agrego mas enlaces dentro de la misma subred");
                        return primer_octeto + "." + segundo_octeto + "." + tercer_octeto + "." + cuarto_octeto
                                + "," + primero_mascara + "." + segundo_mascara + "." + tercero_mascara + "."
                                + cuarto_mascara + "," + nuevo_numero_de_enlaces + "," + "agregoensubred";
                    } else {
                        cuarto_mascara = cuarto_mascara_temporal;
                        System.out.println("se agrego una nueva subred diferente no existente a la base de datos");
                        return primer_octeto + "." + segundo_octeto + "." + tercer_octeto + "." + cuarto_octeto
                                + "," + primero_mascara + "." + segundo_mascara + "." + tercero_mascara + "."
                                + cuarto_mascara + "," + nuevo_numero_de_enlaces;
                    }

                } else {

                    if (mensaje_de_aceptacion.equals("si")) {
                        cuarto_mascara = cuarto_mascara_temporal;
                        int closeSelected = JOptionPane.showConfirmDialog(null, "¿Desea asignar un nueva\n subred Si/No?", "Alerta", JOptionPane.YES_NO_OPTION);
                        if (closeSelected == JOptionPane.YES_OPTION) {
                            System.out.println("se cambio la mascara cuando habia enlaces anteriores");
                            return primer_octeto + "." + segundo_octeto + "." + tercer_octeto + "." + cuarto_octeto
                                    + "," + primero_mascara + "." + segundo_mascara + "." + tercero_mascara + "."
                                    + cuarto_mascara + "," + nuevo_numero_de_enlaces + "," + "cambiodemascara";
                        } else {
                            return "";
                        }
                    } else {
                        System.out.println("");
                        return primer_octeto + "." + segundo_octeto + "." + tercer_octeto + "." + cuarto_octeto
                                + "," + primero_mascara + "." + segundo_mascara + "." + tercero_mascara + "."
                                + cuarto_mascara + "," + nuevo_numero_de_enlaces;
                    }
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
        return lineassh;
    }

    //Función que se encarga de seleccionar el dispositivo PE recibiendo como dato de entrada
    //un string con el nombre de la ciudad y un ComboBox de los dispositivos PE
    public void seleccionarPE(String ciudad, JComboBox jComboPE) {
        if (ciudad.equals("UIO")) {
            jComboPE.setSelectedItem("PE1-UIO");
        } else if (ciudad.equals("ISP")) {

        }
    }

    //Función que se encarga de devolver un valor en binario recibiendo como dato de
    //entrada un entero con el número de VLAN y otro con la cantidad de bits que desea obtener
    //y devuelve como salida un arreglo de enteros compuesto de unos y ceros
    private ArrayList<Integer> binario_list(int Vlan_Empresa, int cant_bits) {
        int auxVlan = Vlan_Empresa;
        ArrayList<Integer> binarioVlan = new ArrayList<Integer>();
        ArrayList<Integer> devolver = new ArrayList<Integer>();
        int verificador;
        for (int i = 0; i < cant_bits; i++) {
            verificador = auxVlan % 2;
            auxVlan = auxVlan / 2;
            if (verificador == 1) {
                binarioVlan.add(1);
            } else {
                binarioVlan.add(0);
            }
        }
        for (int i = 0; i < cant_bits; i++) {
            devolver.add(binarioVlan.get(cant_bits - 1 - i));
        }
        return devolver;
    }
}
